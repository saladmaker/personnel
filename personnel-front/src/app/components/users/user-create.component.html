<div class="w-full lg:w-3/5 mx-auto">
  <p-card class="mt-8 shadow-lg rounded-xl">
    <h2 class="text-xl font-semibold mb-4 text-gray-700">Créer un utilisateur</h2>

    <form
      [formGroup]="createUserForm"
      (ngSubmit)="onSubmit()"
      class="space-y-4"
      autocomplete="off"
    >
      <!-- Nom -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Nom</label>
        <input
          pInputText
          formControlName="name"
          class="w-full"
          autocomplete="off"
        />
        @if (f.name.touched && f.name.invalid) {
          <small class="text-red-500">Le nom est requis.</small>
        }
      </div>

      <!-- Email -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
        <input
          pInputText
          formControlName="email"
          class="w-full"
          autocomplete="off"
        />
        @if (f.email.touched && f.email.hasError('required')) {
          <small class="text-red-500">L'email est requis.</small>
        }
        @if (f.email.touched && f.email.hasError('email')) {
          <small class="text-red-500">Format d'email invalide.</small>
        }
      </div>

      <!-- Mot de passe -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Mot de passe</label>
        <p-password
          formControlName="password"
          [feedback]="false"
          class="w-full"
          inputStyleClass="w-full"
        ></p-password>
        @if (f.password.touched && f.password.hasError('required')) {
          <small class="text-red-500">Le mot de passe est requis.</small>
        }
        @if (f.password.touched && f.password.hasError('minlength')) {
          <small class="text-red-500">Au moins 8 caractères.</small>
        }
      </div>

      <!-- Rôles -->
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Rôles</label>
        <p-multiSelect
          [options]="roles"
          formControlName="roles"
          display="chip"
          class="w-full"
          optionLabel=""
          [filter]="false"
          [showClear]="true"
          [panelStyle]="{ 'max-height': '200px' }"
        >
          <ng-template let-role pTemplate="item">
            <span class="capitalize">{{ role }}</span>
          </ng-template>
        </p-multiSelect>
        @if (f.roles.touched && f.roles.invalid) {
          <small class="text-red-500">Sélectionnez au moins un rôle.</small>
        }
      </div>

      <!-- Messages -->
      @if (successMessage) {
        <div class="text-green-600 text-sm">{{ successMessage }}</div>
      }
      @if (errorMessage) {
        <div class="text-red-600 text-sm">{{ errorMessage }}</div>
      }

      <!-- Submit -->
      <button
        pButton
        type="submit"
        label="Créer l'utilisateur"
        [disabled]="loading"
        class="w-full bg-blue-600 hover:bg-blue-700 text-white"
      ></button>
    </form>
  </p-card>
</div>
